# [Medium] __Web Application Potentially Vulnerable to Clickjacking__

## __Description__

The remote web server does not set an `X-Frame-Options` response header or a *Content-Security-Policy* '`frame-ancestors`' response header in all content responses. This could potentially expose the site to a clickjacking or UI redress attack, in which an attacker can trick a user into clicking an area of the vulnerable page that is different than what the user perceives the page to be. This can result in a user performing fraudulent or malicious transactions.

__X-Frame-Options__ has been proposed by Microsoft as a way to mitigate *clickjacking* attacks and is currently supported by all major browser vendors.

__Content-Security-Policy__ (*CSP*) has been proposed by the *W3C Web Application Security Working Group*, with increasing support among all major browser vendors, as a way to mitigate *clickjacking and other* attacks. The '*frame-ancestors*' policy directive restricts which sources can embed the protected resource.

> __NOTE:__
>
> That while the `X-Frame-Options` and `Content-Security-Policy` response headers are not the only mitigations for clickjacking, they are currently the most reliable methods that can be detected through automation. Therefore, this plugin may produce false positives if other mitigation strategies (*e.g., frame-busting JavaScript*) are deployed or if the page does not perform any security-sensitive transactions.

## __Solution__

Return the `X-Frame-Options` or `Content-Security-Policy` (*with the 'frame-ancestors' directive*) HTTP header with the page's response.

This prevents the page's content from being rendered by another site when using the frame or iframe HTML tags.

> __See Also:__
>
> - <http://www.nessus.org/u?399b1f56>
>
> - <https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet>
>
> - <https://en.wikipedia.org/wiki/Clickjacking>

Output

```sh
The following pages do not use a clickjacking mitigation response header and contain a clickable event :

- http://178.172.195.18:11166/phpmyadmin/doc/html/
- http://178.172.195.18:11166/phpmyadmin/doc/html/bookmarks.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/charts.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/copyright.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/credits.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/developers.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/genindex.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/glossary.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/import_export.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/index.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/intro.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/other.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/privileges.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/relations.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/require.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/search.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/security.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/settings.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/setup.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/themes.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/transformations.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/two_factor.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/user.html
- http://178.172.195.18:11166/phpmyadmin/doc/html/vendors.html
```

To see debug logs, please visit individual host

| Port                  | Hosts             |
|:---------------------:|:-----------------:|
| `11166` / tcp / www   | `178.172.195.18`  |

## __Plugin Details__

- __Severity:__ *Medium*
- __ID:__ *85582*
- __Version:__ *$Revision: 1.7 $*
- __Type:__ *remote*
- __Family:__ *Web Servers*
- __Published:__ *August 22, 2015*
- __Modified:__ *May 16, 2017*

## __Risk Information__

- __Risk Factor:__ *Medium*

- __CVSS v2.0 Base Score:__ *4.3*
- __CVSS v2.0 Vector:__ *`CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N`*

## __Reference Information__

__CWE:__  [693][693]

[693]:              http://cwe.mitre.org/data/definitions/693
