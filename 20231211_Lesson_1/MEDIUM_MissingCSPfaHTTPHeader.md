# [Lesson 1 report](./20231211_lesson_1.md) -> __Content Security Policy (*CSP*) Header Not Set__

## __Details__

- __Severity:__ *Medium*
- __Family:__ *CGI abuses*

## __Risk Information__

- __Risk Factor:__ *Medium*

## __Reference Information__

__CVE:__  [693][693]

[693]:    https://cwe.mitre.org/data/definitions/693.html

## __Summary__

The remote web server in some responses sets a permissive __Content-Security-Policy__ (*CSP*) frame-ancestors response header or does not set one at all. Proposed by the W3C Web Application Security Working Group, CSP is an additional layer of security that helps detect and mitigate certain types of attacks, including __cross-site scripting__ (*XSS*) and data __injection attacks__. These attacks are used for a variety of purposes, from stealing data to damaging a website or spreading malware. CSP provides a set of standard HTTP headers that allow website owners to declare approved content sources that browsers should be allowed to load on that page. Supported types include *JavaScript*, *CSS*, *HTML frames*, *fonts*, *images*, and embedded objects such as *Java applets*, *ActiveX*, *audio* and *video* files.

## __Solution__

Ensure that the web server, application server, load balancer, etc. is configured to set the *Content-Security-Policy* header. Set a __non-permissive__ *Content-Security-Policy frame-ancestors* header for all requested resources.

> __See Also:__
>
> - <https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP>
>
> - <https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html>
>
> - <https://content-security-policy.com/>
>
> - <https://www.w3.org/TR/CSP2/>

## __Detection__

The following pages do not set a *Content-Security-Policy frame-ancestors* response header or set a permissive policy:

```sh
http://178.172.195.18:11166/
http://178.172.195.18:11166//
http://178.172.195.18:11166/admin/
http://178.172.195.18:11166/phpmyadmin/
http://178.172.195.18:11166/phpmyadmin/index.php
http://178.172.195.18:11166/phpmyadmin/doc/html/
http://178.172.195.18:11166/phpmyadmin/doc/html/bookmarks.html
http://178.172.195.18:11166/phpmyadmin/doc/html/charts.html
http://178.172.195.18:11166/phpmyadmin/doc/html/copyright.html
http://178.172.195.18:11166/phpmyadmin/doc/html/credits.html
http://178.172.195.18:11166/phpmyadmin/doc/html/developers.html
http://178.172.195.18:11166/phpmyadmin/doc/html/genindex.html
http://178.172.195.18:11166/phpmyadmin/doc/html/glossary.html
http://178.172.195.18:11166/phpmyadmin/doc/html/import_export.html
http://178.172.195.18:11166/phpmyadmin/doc/html/index.html
http://178.172.195.18:11166/phpmyadmin/doc/html/intro.html
http://178.172.195.18:11166/phpmyadmin/doc/html/other.html
http://178.172.195.18:11166/phpmyadmin/doc/html/privileges.html
http://178.172.195.18:11166/phpmyadmin/doc/html/relations.html
http://178.172.195.18:11166/phpmyadmin/doc/html/require.html
http://178.172.195.18:11166/phpmyadmin/doc/html/search.html
http://178.172.195.18:11166/phpmyadmin/doc/html/security.html
http://178.172.195.18:11166/phpmyadmin/doc/html/settings.html
http://178.172.195.18:11166/phpmyadmin/doc/html/setup.html
http://178.172.195.18:11166/phpmyadmin/doc/html/themes.html
http://178.172.195.18:11166/phpmyadmin/doc/html/transformations.html
http://178.172.195.18:11166/phpmyadmin/doc/html/two_factor.html
http://178.172.195.18:11166/phpmyadmin/doc/html/user.html
http://178.172.195.18:11166/phpmyadmin/doc/html/vendors.html
```
