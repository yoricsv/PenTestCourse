# [Lesson 1 report](./20231211_lesson_1.md) -> __Missing Anti-clickjacking Header__

## __Details__

- __Severity:__ *Medium*
- __Family:__ *Web Servers*

## __Risk Information__

- __Risk Factor:__ *Medium*

## __Reference Information__

__CWE:__  [1021][1021]

[1021]:    https://www.zaproxy.org/alerttags/cwe-1021

## __Summary__

The remote web server in some responses sets a permissive `X-Frame-Options` response header or does not set one at all.

The X-Frame-Options header has been proposed by Microsoft as a way to mitigate __clickjacking__ attacks and is currently supported by all major browser vendors.

This could potentially expose the site to a clickjacking or UI redress attack, in which an attacker can trick a user into clicking an area of the vulnerable page that is different than what the user perceives the page to be. This can result in a user performing fraudulent or malicious transactions.

## __Solution__

Modern web browsers support the *Content-Security-Policy* and `X-Frame-Options` HTTP headers. Make sure one of these is set on all web pages returned by the site or application. If the page is to be generated only by pages on the server (*eg it is part of a `FRAMESET`*) then `SAMEORIGIN` should be used, otherwise if the page will never be generated in a frame then `DENY` should be used. As an alternative, consider implementing the Content Security Policy's "*frame-ancestors*" directive.

__Set a properly configured__ `X-Frame-Options` header for all requested resources.

This prevents the page's content from being rendered by another site when using the frame or iframe HTML tags.

> __See Also:__
>
> - <https://en.wikipedia.org/wiki/Clickjacking>
>
> - <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options>
>
> - <https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet>

## __Detection__

The following pages do not set a *X-Frame-Options* response header or set a permissive policy:

```sh
http://178.172.195.18:11166/
http://178.172.195.18:11166//
http://178.172.195.18:11166/admin/
http://178.172.195.18:11166/phpmyadmin/doc/html/
http://178.172.195.18:11166/phpmyadmin/doc/html/bookmarks.html
http://178.172.195.18:11166/phpmyadmin/doc/html/charts.html
http://178.172.195.18:11166/phpmyadmin/doc/html/copyright.html
http://178.172.195.18:11166/phpmyadmin/doc/html/credits.html
http://178.172.195.18:11166/phpmyadmin/doc/html/developers.html
http://178.172.195.18:11166/phpmyadmin/doc/html/genindex.html
http://178.172.195.18:11166/phpmyadmin/doc/html/glossary.html
http://178.172.195.18:11166/phpmyadmin/doc/html/import_export.html
http://178.172.195.18:11166/phpmyadmin/doc/html/index.html
http://178.172.195.18:11166/phpmyadmin/doc/html/intro.html
http://178.172.195.18:11166/phpmyadmin/doc/html/other.html
http://178.172.195.18:11166/phpmyadmin/doc/html/privileges.html
http://178.172.195.18:11166/phpmyadmin/doc/html/relations.html
http://178.172.195.18:11166/phpmyadmin/doc/html/require.html
http://178.172.195.18:11166/phpmyadmin/doc/html/search.html
http://178.172.195.18:11166/phpmyadmin/doc/html/security.html
http://178.172.195.18:11166/phpmyadmin/doc/html/settings.html
http://178.172.195.18:11166/phpmyadmin/doc/html/setup.html
http://178.172.195.18:11166/phpmyadmin/doc/html/themes.html
http://178.172.195.18:11166/phpmyadmin/doc/html/transformations.html
http://178.172.195.18:11166/phpmyadmin/doc/html/two_factor.html
http://178.172.195.18:11166/phpmyadmin/doc/html/user.html
http://178.172.195.18:11166/phpmyadmin/doc/html/vendors.html
```
